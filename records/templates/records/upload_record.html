{% extends "base1.html" %}

{% block content %}
{% if messages %}
<div class="alert alert-danger">
    <ul>
        {% for message in messages %}
        <li>{{ message }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}
<div class="container">
    <h2>Ajouter un dossier médical pour {{ patient.user.username }}</h2>
    <div class="card mt-4">
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data" id="uploadForm">
                
                
                {% csrf_token %}
                <div class="accordion-section">
                  <div class="accordion-header" data-target="pathologies-content">
                    <h3>Pathologies</h3>
                    <span class="accordion-icon">+</span>
                  </div>
                  <div class="accordion-content" id="pathologies-content">
                    <div class="pathologies">
                <div class="form-check mb-4">
                  <input class="form-check-input" type="checkbox" value="1" id="diabetique" name="diabetique">
                  <label class="form-check-label" for="diabetique">
                    Diabétique
                  </label>
                </div>
                
                <div class="form-check mb-4">
                  <input class="form-check-input" type="checkbox" value="1" id="hypertendu" name="hypertendu">
                  <label class="form-check-label" for="hypertendu">
                    Hypertendu
                  </label>
                </div>
                
                <div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="keratoconique" name="keratoconique" onchange="toggleKeratoconiqueStade()">
  <label class="form-check-label" for="keratoconique">
    Kératoconique
  </label>
</div>
<div class="mb-4" id="keratoconique-stade-container" style="display:none;">
  <label for="stade_keratoconique" class="form-label">Stade du kératoconique</label>
  <select class="form-control" id="stade_keratoconique" name="stade_keratoconique">
    <option value="">-- Sélectionner --</option>
    <option value="fruste">Kératocône fruste</option>
    <option value="stade_1">Stade 1</option>
    <option value="stade_2">Stade 2</option>
    <option value="stade_3">Stade 3</option>
    <option value="stade_4">Stade 4</option>
  </select>
</div>
<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="cataracte" name="cataracte" onchange="toggleCataracteType()">
  <label class="form-check-label" for="cataracte">
    Cataracte
  </label>
</div>
<div class="mb-4" id="cataracte-type-container" style="display:none;">
  <label for="cataracte_type" class="form-label">Type de cataracte</label>
  <select class="form-control" id="cataracte_type" name="cataracte_type">
    <option value="">-- Sélectionner --</option>
    <option value="nucléaire">Cataracte nucléaire</option>
    <option value="corticale">Cataracte corticale</option>
    <option value="sous-capsulaire postérieure">Cataracte sous-capsulaire postérieure</option>
    <option value="congénitale">Cataracte congénitale</option>
    <option value="traumatique">Cataracte traumatique</option>
    <option value="secondaire">Cataracte secondaire</option>
  </select>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="glaucome" name="glaucome" onchange="toggleGlaucomeType()">
  <label class="form-check-label" for="glaucome">
    Glaucome
  </label>
</div>
<div class="mb-4" id="glaucome-type-container" style="display:none;">
  <label for="glaucome_type" class="form-label">Type de glaucome</label>
  <select class="form-control" id="glaucome_type" name="glaucome_type">
    <option value="">-- Sélectionner --</option>
    <option value="angle_ouvert">Glaucome à angle ouvert</option>
    <option value="angle_ferme">Glaucome à angle fermé</option>
  </select>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="uveite" name="uveite" onchange="toggleUveiteType()">
  <label class="form-check-label" for="uveite">
    Uvéite
  </label>
</div>
<div class="mb-4" id="uveite-type-container" style="display:none;">
  <label for="uveite_type" class="form-label">Type d'uvéite</label>
  <select class="form-control" id="uveite_type" name="uveite_type">
    <option value="">-- Sélectionner --</option>
    <option value="anterieure">Uvéite antérieure</option>
    <option value="intermediaire">Uvéite intermédiaire</option>
    <option value="posterieure">Uvéite postérieure</option>
    <option value="panuveite">Panuvéite</option>
  </select>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="conjonctivite" name="conjonctivite" onchange="toggleConjonctiviteType()">
  <label class="form-check-label" for="conjonctivite">
    Conjonctivite
  </label>
</div>
<div class="mb-4" id="conjonctivite-type-container" style="display:none;">
  <label for="conjonctivite_type" class="form-label">Type de conjonctivite</label>
  <select class="form-control" id="conjonctivite_type" name="conjonctivite_type">
    <option value="">-- Sélectionner --</option>
    <option value="bacterienne">Conjonctivite bactérienne</option>
    <option value="virale">Conjonctivite virale</option>
    <option value="allergique">Conjonctivite allergique</option>
    <option value="irritative">Conjonctivite irritative</option>
    <option value="toxique">Conjonctivite toxique</option>
    <option value="autoimmune">Conjonctivite auto-immune</option>
    <option value="neonatale">Conjonctivite néonatale</option>
  </select>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="sclerose" name="sclerose" onchange="toggleScleroseType()">
  <label class="form-check-label" for="sclerose">
    Sclérose
  </label>
</div>
<div class="mb-4" id="sclerose-type-container" style="display:none;">
  <label for="sclerose_type" class="form-label">Type de sclérose</label>
  <select class="form-control" id="sclerose_type" name="sclerose_type">
    <option value="">-- Sélectionner --</option>
    <option value="anterieure">Sclérite antérieure</option>
    <option value="posterieure">Sclérite postérieure</option>
    <option value="episclerite">Épisclérite</option>
    <option value="nodulaire">Sclérite nodulaire</option>
    <option value="necrosante_inflammation">Sclérite nécrosante avec inflammation</option>
    <option value="necrosante_sans_inflammation">Sclérite nécrosante sans inflammation (scléromalacie perforante)</option>
  </select>
</div>
    </div>
    </div>
    </div>
    



    <div class="accordion-section">
      <div class="accordion-header" data-target="examens-content">
        <h3>Examens</h3>
        <span class="accordion-icon">+</span>
      </div>
      <div class="accordion-content" id="examens-content">
        <div class="examens">
        
    

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="tonometry" name="tonometry" onchange="toggleTonometryDescription()">
  <label class="form-check-label" for="tonometry">
    Tonometry
  </label>
</div>
<div class="mb-4" id="tonometry-description-container" style="display:none;">
  <label for="description_tonometry" class="form-label">Description tonometry</label>
  <textarea class="form-control" id="description_tonometry" name="description_tonometry" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="v3m" name="v3m" onchange="toggleV3MDescription()">
  <label class="form-check-label" for="v3m">
    V3M
  </label>
</div>
<div class="mb-4" id="v3m-description-container" style="display:none;">
  <label for="description_v3m" class="form-label">Description V3M</label>
  <textarea class="form-control" id="description_v3m" name="description_v3m" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="fo" name="fo" onchange="toggleFODescription()">
  <label class="form-check-label" for="fo">
    F.O
  </label>
</div>
<div class="mb-4" id="fo-description-container" style="display:none;">
  <label for="description_fo" class="form-label">Description F.O</label>
  <textarea class="form-control" id="description_fo" name="description_fo" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="ce" name="ce" onchange="toggleCEDescription()">
  <label class="form-check-label" for="ce">
    C.E
  </label>
</div>
<div class="mb-4" id="ce-description-container" style="display:none;">
  <label for="description_ce" class="form-label">Description C.E</label>
  <textarea class="form-control" id="description_ce" name="description_ce" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="scjr" name="scjr" onchange="toggleSCJRDescription()">
  <label class="form-check-label" for="scjr">
    S/Cj -R/B
  </label>
</div>
<div class="mb-4" id="scjr-description-container" style="display:none;">
  <label for="description_scjr" class="form-label">Description S/Cj -R/B</label>
  <textarea class="form-control" id="description_scjr" name="description_scjr" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="vi" name="vi" onchange="toggleVIDescription()">
  <label class="form-check-label" for="vi">
    V.I
  </label>
</div>
<div class="mb-4" id="vi-description-container" style="display:none;">
  <label for="description_vi" class="form-label">Description V.I</label>
  <textarea class="form-control" id="description_vi" name="description_vi" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="ablation_fils" name="ablation_fils" onchange="toggleAblationFilsDescription()">
  <label class="form-check-label" for="ablation_fils">
    Ablation de Fils
  </label>
</div>
<div class="mb-4" id="ablation_fils-description-container" style="display:none;">
  <label for="description_ablation_fils" class="form-label">Description Ablation de Fils</label>
  <textarea class="form-control" id="description_ablation_fils" name="description_ablation_fils" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="echo_a" name="echo_a" onchange="toggleEchoADescription()">
  <label class="form-check-label" for="echo_a">
    Echo A
  </label>
</div>
<div class="mb-4" id="echo_a-description-container" style="display:none;">
  <label for="description_echo_a" class="form-label">Description Echo A</label>
  <textarea class="form-control" id="description_echo_a" name="description_echo_a" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="echo_b" name="echo_b" onchange="toggleEchoBDescription()">
  <label class="form-check-label" for="echo_b">
    Echo B
  </label>
</div>
<div class="mb-4" id="echo_b-description-container" style="display:none;">
  <label for="description_echo_b" class="form-label">Description Echo B</label>
  <textarea class="form-control" id="description_echo_b" name="description_echo_b" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="skiascopie" name="skiascopie" onchange="toggleSkiascopieDescription()">
  <label class="form-check-label" for="skiascopie">
    Skiascopie
  </label>
</div>
<div class="mb-4" id="skiascopie-description-container" style="display:none;">
  <label for="description_skiascopie" class="form-label">Description Skiascopie</label>
  <textarea class="form-control" id="description_skiascopie" name="description_skiascopie" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="laser_argon" name="laser_argon" onchange="toggleLaserArgonDescription()">
  <label class="form-check-label" for="laser_argon">
    Laser Argon
  </label>
</div>
<div class="mb-4" id="laser_argon-description-container" style="display:none;">
  <label for="description_laser_argon" class="form-label">Description Laser Argon</label>
  <textarea class="form-control" id="description_laser_argon" name="description_laser_argon" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="laser_yag" name="laser_yag" onchange="toggleLaserYAGDescription()">
  <label class="form-check-label" for="laser_yag">
    Laser YAG
  </label>
</div>
<div class="mb-4" id="laser_yag-description-container" style="display:none;">
  <label for="description_laser_yag" class="form-label">Description Laser YAG</label>
  <textarea class="form-control" id="description_laser_yag" name="description_laser_yag" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="angio" name="angio" onchange="toggleAngioDescription()">
  <label class="form-check-label" for="angio">
    Angio
  </label>
</div>
<div class="mb-4" id="angio-description-container" style="display:none;">
  <label for="description_angio" class="form-label">Description Angio</label>
  <textarea class="form-control" id="description_angio" name="description_angio" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="lentille_therap" name="lentille_therap" onchange="toggleLentilleTherapDescription()">
  <label class="form-check-label" for="lentille_therap">
    Lentille Therap
  </label>
</div>
<div class="mb-4" id="lentille_therap-description-container" style="display:none;">
  <label for="description_lentille_therap" class="form-label">Description Lentille Therap</label>
  <textarea class="form-control" id="description_lentille_therap" name="description_lentille_therap" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="bouchons_lacrym" name="bouchons_lacrym" onchange="toggleBouchonsLacrymDescription()">
  <label class="form-check-label" for="bouchons_lacrym">
    Bouchons Lacrym
  </label>
</div>
<div class="mb-4" id="bouchons_lacrym-description-container" style="display:none;">
  <label for="description_bouchons_lacrym" class="form-label">Description Bouchons Lacrym</label>
  <textarea class="form-control" id="description_bouchons_lacrym" name="description_bouchons_lacrym" rows="3"></textarea>
</div>

<!-- Ajout des champs pour les tests de couleur et de qualité des larmes -->
<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="test_couleur" name="test_couleur" onchange="toggleTestCouleurDescription()">
  <label class="form-check-label" for="test_couleur">
    Test de couleur
  </label>
</div>
<div class="mb-4" id="test_couleur-description-container" style="display:none;">
  <label for="description_test_couleur" class="form-label">Description du test de couleur</label>
  <textarea class="form-control" id="description_test_couleur" name="description_test_couleur" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="test_larmes" name="test_larmes" onchange="toggleTestLarmesDescription()">
  <label class="form-check-label" for="test_larmes">
    Test de qualité des larmes
  </label>
</div>
<div class="mb-4" id="test_larmes-description-container" style="display:none;">
  <label for="description_test_larmes" class="form-label">Description du test de qualité des larmes</label>
  <textarea class="form-control" id="description_test_larmes" name="description_test_larmes" rows="3"></textarea>
</div>
</div>
</div>
</div>


<!-- Examens optométriques -->
<div class="accordion-section">
  <div class="accordion-header" data-target="examens-optométriques-content">
    <h3>Examens optométriques</h3>
    <span class="accordion-icon">+</span>
  </div>
  <div class="accordion-content" id="examens-optométriques-content">
    <div class="examens-optométriques">

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="acuite_visuelle_brute" name="acuite_visuelle_brute" onchange="toggleAcuiteVisuelleBruteDescription()">
  <label class="form-check-label" for="acuite_visuelle_brute">
    Acuité visuelle brute
  </label>
</div>
<div class="mb-4" id="acuite_visuelle_brute-description-container" style="display:none;">
  <label for="description_acuite_visuelle_brute" class="form-label">Description de l'acuité visuelle brute</label>
  <textarea class="form-control" id="description_acuite_visuelle_brute" name="description_acuite_visuelle_brute" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="acuite_visuelle_correction" name="acuite_visuelle_correction" onchange="toggleAcuiteVisuelleCorrectionDescription()">
  <label class="form-check-label" for="acuite_visuelle_correction">
    Acuité visuelle avec correction
  </label>
</div>
<div class="mb-4" id="acuite_visuelle_correction-description-container" style="display:none;">
  <label for="description_acuite_visuelle_correction" class="form-label">Description de l'acuité visuelle avec correction</label>
  <textarea class="form-control" id="description_acuite_visuelle_correction" name="description_acuite_visuelle_correction" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="acuite_visuelle_cycloplefie" name="acuite_visuelle_cycloplefie" onchange="toggleAcuiteVisuelleCycloplefieDescription()">
  <label class="form-check-label" for="acuite_visuelle_cycloplefie">
    Acuité visuelle sous cycloplégie
  </label>
</div>
<div class="mb-4" id="acuite_visuelle_cycloplefie-description-container" style="display:none;">
  <label for="description_acuite_visuelle_cycloplefie" class="form-label">Description de l'acuité visuelle sous cycloplégie</label>
  <textarea class="form-control" id="description_acuite_visuelle_cycloplefie" name="description_acuite_visuelle_cycloplefie" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="amplitude_accommodation" name="amplitude_accommodation" onchange="toggleAmplitudeAccommodationDescription()">
  <label class="form-check-label" for="amplitude_accommodation">
    Amplitude d'accommodation
  </label>
</div>
<div class="mb-4" id="amplitude_accommodation-description-container" style="display:none;">
  <label for="description_amplitude_accommodation" class="form-label">Description de l'amplitude d'accommodation</label>
  <textarea class="form-control" id="description_amplitude_accommodation" name="description_amplitude_accommodation" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="flexibilite_accommodative" name="flexibilite_accommodative" onchange="toggleFlexibiliteAccommodativeDescription()">
  <label class="form-check-label" for="flexibilite_accommodative">
    Flexibilité accommodative (test avec flippers)
  </label>
</div>
<div class="mb-4" id="flexibilite_accommodative-description-container" style="display:none;">
  <label for="description_flexibilite_accommodative" class="form-label">Description de la flexibilité accommodative</label>
  <textarea class="form-control" id="description_flexibilite_accommodative" name="description_flexibilite_accommodative" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="reponse_accommodative" name="reponse_accommodative" onchange="toggleReponseAccommodativeDescription()">
  <label class="form-check-label" for="reponse_accommodative">
    Réponse accommodative (MEM, FCC)
  </label>
</div>
<div class="mb-4" id="reponse_accommodative-description-container" style="display:none;">
  <label for="description_reponse_accommodative" class="form-label">Description de la réponse accommodative</label>
  <textarea class="form-control" id="description_reponse_accommodative" name="description_reponse_accommodative" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="tests_muscles_oculomoteurs" name="tests_muscles_oculomoteurs" onchange="toggleTestsMusclesOculomoteursDescription()">
  <label class="form-check-label" for="tests_muscles_oculomoteurs">
    Tests d'évaluation des muscles oculomoteurs
  </label>
</div>
<div class="mb-4" id="tests_muscles_oculomoteurs-description-container" style="display:none;">
  <label for="description_tests_muscles_oculomoteurs" class="form-label">Description des tests des muscles oculomoteurs</label>
  <textarea class="form-control" id="description_tests_muscles_oculomoteurs" name="description_tests_muscles_oculomoteurs" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="cover_test" name="cover_test" onchange="toggleCoverTestDescription()">
  <label class="form-check-label" for="cover_test">
    Cover test (de près et de loin)
  </label>
</div>
<div class="mb-4" id="cover_test-description-container" style="display:none;">
  <label for="description_cover_test" class="form-label">Description du cover test</label>
  <textarea class="form-control" id="description_cover_test" name="description_cover_test" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="heterophories" name="heterophories" onchange="toggleHeterophoriesDescription()">
  <label class="form-check-label" for="heterophories">
    Hétérophories / Hétérotropies
  </label>
</div>
<div class="mb-4" id="heterophories-description-container" style="display:none;">
  <label for="description_heterophories" class="form-label">Description des hétérophories/hétérotropies</label>
  <textarea class="form-control" id="description_heterophories" name="description_heterophories" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="vergences" name="vergences" onchange="toggleVergencesDescription()">
  <label class="form-check-label" for="vergences">
    Vergences (amplitudes, réserves, souplesses)
  </label>
</div>
<div class="mb-4" id="vergences-description-container" style="display:none;">
  <label for="description_vergences" class="form-label">Description des vergences</label>
  <textarea class="form-control" id="description_vergences" name="description_vergences" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="test_maddox" name="test_maddox" onchange="toggleTestMaddoxDescription()">
  <label class="form-check-label" for="test_maddox">
    Test du Maddox (phories horizontales et verticales)
  </label>
</div>
<div class="mb-4" id="test_maddox-description-container" style="display:none;">
  <label for="description_test_maddox" class="form-label">Description du test du Maddox</label>
  <textarea class="form-control" id="description_test_maddox" name="description_test_maddox" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="test_worth" name="test_worth" onchange="toggleTestWorthDescription()">
  <label class="form-check-label" for="test_worth">
    Test de Worth
  </label>
</div>
<div class="mb-4" id="test_worth-description-container" style="display:none;">
  <label for="description_test_worth" class="form-label">Description test de Worth</label>
  <textarea class="form-control" id="description_test_worth" name="description_test_worth" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="keratometrie" name="keratometrie" onchange="toggleKeratometrieDescription()">
  <label class="form-check-label" for="keratometrie">
    Kératométrie
  </label>
</div>
<div class="mb-4" id="keratometrie-description-container" style="display:none;">
  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="keratometrie_od" class="form-label">Kératométrie OD</label>
      <input type="text" class="form-control" id="keratometrie_od" name="keratometrie_od" placeholder="Ex: 43.50 @ 180">
    </div>
    <div class="col-md-6 mb-3">
      <label for="keratometrie_og" class="form-label">Kératométrie OG</label>
      <input type="text" class="form-control" id="keratometrie_og" name="keratometrie_og" placeholder="Ex: 44.00 @ 90">
    </div>
  </div>
  <label for="description_keratometrie" class="form-label">Description kératométrie</label>
  <textarea class="form-control" id="description_keratometrie" name="description_keratometrie" rows="3"></textarea>
</div>

<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="stereoscopie" name="stereoscopie" onchange="toggleSterescopieDescription()">
  <label class="form-check-label" for="stereoscopie">
    Stéréoscopie (TNO, Titmus, etc.)
  </label>
</div>
<div class="mb-4" id="stereoscopie-description-container" style="display:none;">
  <label for="description_stereoscopie" class="form-label">Description de la stéréoscopie</label>
  <textarea class="form-control" id="description_stereoscopie" name="description_stereoscopie" rows="3"></textarea>
</div>
</div>
</div>
</div>





<!-- Lentille de contact section -->
<div class="mb-4">
  <h4 class="form-label">Lentille de contact :</h4>
</div>
<div class="form-check mb-2">
  <input class="form-check-input" type="checkbox" value="1" id="lentille_souple" name="lentille_souple" onchange="toggleLentilleSoupleOptions()">
  <label class="form-check-label fw-bold" for="lentille_souple">
    Lentille souple
  </label>
</div>
<div class="ms-4 mb-2" id="lentille-souple-options" style="display:none;">
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lentille_souple_spherique" name="lentille_souple_spherique">
    <label class="form-check-label" for="lentille_souple_spherique">
      Lentille souple sphérique
    </label>
  </div>
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lentille_souple_torique" name="lentille_souple_torique">
    <label class="form-check-label" for="lentille_souple_torique">
      Lentille souple torique
    </label>
  </div>
</div>
<div class="form-check mb-2">
  <input class="form-check-input" type="checkbox" value="1" id="lentille_rpg" name="lentille_rpg" onchange="toggleLentilleRPGOptions()">
  <label class="form-check-label fw-bold" for="lentille_rpg">
    Lentille RPG
  </label>
</div>
<div class="ms-4 mb-2" id="lentille-rpg-options" style="display:none;">
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lrpg_spherique" name="lrpg_spherique">
    <label class="form-check-label" for="lrpg_spherique">
      LRPG sphérique
    </label>
  </div>
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lrpg_torique_ant" name="lrpg_torique_ant">
    <label class="form-check-label" for="lrpg_torique_ant">
      LRPG torique face antérieure
    </label>
  </div>
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lrpg_torique_post" name="lrpg_torique_post">
    <label class="form-check-label" for="lrpg_torique_post">
      LRPG torique face postérieure
    </label>
  </div>
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="1" id="lrpg_bitorique" name="lrpg_bitorique">
    <label class="form-check-label" for="lrpg_bitorique">
      LRPG bi-torique
    </label>
  </div>
</div>
<div class="form-check mb-4">
  <input class="form-check-input" type="checkbox" value="1" id="lentille_sclerale" name="lentille_sclerale">
  <label class="form-check-label fw-bold" for="lentille_sclerale">
    Lentille sclérale
  </label>
</div>



                

                <div class="mb-4">
                  <h2>Ajouter des images</h2>
                  <div class="accordion-section">
                    <div class="accordion-header" data-target="images-content">
                      <h3>Topographie cornéenne</h3>
                      <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content" id="images-content">                    
                    <div class="d-flex align-items-center mb-2">
                        <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('topographie-input').click()">
                            + Ajouter une image
                        </button>
                        <input type="file" id="topographie-input" style="display: none;" accept="image/*">
                    </div>
                    <div id="topographie-container"></div>
                    <div class="image-preview mt-2" id="topographie-preview"></div>
                </div>
                </div>
                </div>
                </div>

                <div class="accordion-section">
                  <div class="accordion-header" data-target="images-content">
                    <h3>OCT</h3>
                    <span class="accordion-icon">+</span>
                  </div>
                  <div class="accordion-content" id="images-content"> 
                        <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('oct-input').click()">
                            + Ajouter une image
                        </button>
                        <input type="file" id="oct-input" style="display: none;" accept="image/*">
                    </div>
                    <div id="oct-container"></div>
                    <div class="image-preview mt-2" id="oct-preview"></div>
                </div>
                </div>
                </div>
                </div>  


               <div class="accordion-section">
                    <div class="accordion-header" data-target="images-content">
                      <h3>Lampe à fente</h3>
                      <span class="accordion-icon">+</span>
                    </div>
                    <div class="accordion-content" id="images-content"> 
                        <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('lampe-input').click()">
                            + Ajouter une image
                        </button>
                        <input type="file" id="lampe-input" style="display: none;" accept="image/*">
                    </div>
                    <div id="lampe-container"></div>
                    <div class="image-preview mt-2" id="lampe-preview"></div>
                </div>
                </div>
                </div>
                </div>
                

                <div class="mb-4">
                    <label class="form-label">Calcul IOL</label>
                    <div class="d-flex align-items-center mb-2">
                        <a href="https://www.myalcon-toriccalc.com/#/calculator" target="_blank" class="btn btn-outline-primary">
                            Calcul IOL
                        </a>
                    </div>
                </div>

                <div class="mb-4">
                  <label for="description" class="form-label">Description générale</label>
                  <textarea class="form-control" id="description" name="description" rows="3"></textarea>
                </div>

                <div class="mb-4">
                    <br>
                    <h4 class="form-label">Ordonnance</h4>
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col"></th>
                          <th scope="col">Sph</th>
                          <th scope="col">Cyl</th>
                          <th scope="col">Axe</th>
                          <th scope="col">Add</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th scope="row">OD</th>
                          <td><input type="text" class="form-control" name="od_sph"></td>
                          <td><input type="text" class="form-control" name="od_cyl"></td>
                          <td><input type="text" class="form-control" name="od_axe"></td>
                          <td><input type="text" class="form-control" name="od_add"></td>
                        </tr>
                                                <tr>
                          <th scope="row">OG</th>
                          <td><input type="text" class="form-control" name="og_sph"></td>
                          <td><input type="text" class="form-control" name="og_cyl"></td>
                          <td><input type="text" class="form-control" name="og_axe"></td>
                          <td><input type="text" class="form-control" name="og_add"></td>
                        </tr>
                      </tbody>
                    </table>
                    <table class="table mt-4">
                      <thead>
                        <tr>
                          <th scope="col"></th>
                          <th scope="col">Sph LC</th>
                          <th scope="col">Cyl LC</th>
                          <th scope="col">Axe LC</th>
                          <th scope="col">DIA</th>
                          <th scope="col">RC</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th scope="row">OD</th>
                          <td><input type="text" class="form-control" name="od_sph_lc"></td>
                          <td><input type="text" class="form-control" name="od_cyl_lc"></td>
                          <td><input type="text" class="form-control" name="od_axe_lc"></td>
                          <td><input type="text" class="form-control" name="od_dia"></td>
                          <td><input type="text" class="form-control" name="od_rc"></td>
                        </tr>
                        <tr>
                          <th scope="row">OG</th>
                          <td><input type="text" class="form-control" name="og_sph_lc"></td>
                          <td><input type="text" class="form-control" name="og_cyl_lc"></td>
                          <td><input type="text" class="form-control" name="og_axe_lc"></td>
                          <td><input type="text" class="form-control" name="og_dia"></td>
                          <td><input type="text" class="form-control" name="og_rc"></td>
                        </tr>
                      </tbody>
                    </table>
                </div>

                <div class="mb-4">
                    <label class="form-label">Autres documents</label>
                    <input type="file" class="form-control" name="file">
                </div>
                <div class="mb-4">
                    <!-- <label for="prochain_rendez_vous" class="form-label">Prochain rendez-vous</label> -->
                    <input type="text" name="prochain_rdv" placeholder="Date du prochain rendez-vous" onfocus="(this.type='datetime-local')" >
                </div>
                <a href="{% url 'create_prescription' patient.id %}" class="btn btn-primary mb-3">Créer une ordonnance des médicaments</a> <br>
                <button type="submit" class="btn btn-primary">Enregistrer</button>
            </form>
        </div>
    </div>
</div>

<style>
.image-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    min-height: 50px;
}

.preview-item {
    position: relative;
    width: 150px;
    margin-bottom: 10px;
}

.preview-item img {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.preview-item .file-name {
    font-size: 0.8em;
    word-break: break-all;
    margin-top: 5px;
}

.remove-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(255, 0, 0, 0.7);
    color: white;
    border: none;
    width: 20px;
    height: 20px;
    line-height: 20px;
    text-align: center;
    cursor: pointer;
    border-radius: 50%;
}

.remove-btn:hover {
    background: rgba(255, 0, 0, 0.9);
}

.accordion-section {
  border: 1px solid #ccc;
  margin-bottom: 10px;
  border-radius: 5px;
  overflow: hidden;
}

.accordion-header {
  background-color: #f0f0f0;
  cursor: pointer;
  padding: 10px 15px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  transition: background-color 0.3s ease;
}

.accordion-header:hover {
  background-color: #e0e0e0;
}

.accordion-icon {
  font-size: 18px;
  font-weight: bold;
  transition: transform 0.3s ease;
}

.accordion-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s ease;
}

.accordion-content.open {
  padding: 10px 15px;
  max-height: 1000px; /* assez grand pour tout afficher */
}

.accordion-header.active .accordion-icon {
  transform: rotate(45deg); /* passe le "+" en "x" */
}

</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const imageTypes = ['topographie', 'oct', 'lampe'];
    const selectedFiles = {
        topographie: [],
        oct: [],
        lampe: []
    };

    function createFileInput(type, index) {
        return `<input type="file" name="${type}[]" style="display: none;">`;
    }

    function handleFileSelect(event, type) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            // Créer un nouvel input file caché
            const container = document.getElementById(`${type}-container`);
            const input = document.createElement('input');
            input.type = 'file';
            input.name = `${type}[]`;
            input.style.display = 'none';
            container.appendChild(input);

            // Créer la prévisualisation
            const preview = document.getElementById(`${type}-preview`);
            const div = document.createElement('div');
            div.className = 'preview-item';
            div.innerHTML = `
                <img src="${e.target.result}" alt="Preview">
                <div class="file-name">${file.name}</div>
                <button type="button" class="remove-btn">×</button>
            `;

            // Ajouter le fichier à l'input
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            input.files = dataTransfer.files;

            // Gérer la suppression
            div.querySelector('.remove-btn').onclick = function() {
                div.remove();
                input.remove();
            };

            preview.appendChild(div);
        };
        reader.readAsDataURL(file);

        // Réinitialiser l'input pour permettre la sélection du même fichier
        event.target.value = '';
    }

    // Configurer les écouteurs d'événements pour chaque type d'image
    imageTypes.forEach(type => {
        const input = document.getElementById(`${type}-input`);
        input.addEventListener('change', (e) => handleFileSelect(e, type));
    });

    // Validation du formulaire
    document.getElementById('uploadForm').onsubmit = function(e) {
    const hasFiles = imageTypes.some(type => {
        return document.querySelectorAll(`input[name="${type}[]"]`).length > 0;
    }) || document.querySelector('input[name="file"]').files.length > 0;

    if (!hasFiles) {
        alert('Attention : Aucun fichier ou image n’a été ajouté.');
    }
    return true; // Laisse le formulaire s'envoyer quand même
};

});
function toggleCataracteType() {
  var cataracteCheckbox = document.getElementById('cataracte');
  var cataracteTypeContainer = document.getElementById('cataracte-type-container');
  if (cataracteCheckbox.checked) {
    cataracteTypeContainer.style.display = 'block';
  } else {
    cataracteTypeContainer.style.display = 'none';
    document.getElementById('cataracte_type').value = '';
  }
}
function toggleV3MDescription() {
  var v3mCheckbox = document.getElementById('v3m');
  var v3mDescriptionContainer = document.getElementById('v3m-description-container');
  if (v3mCheckbox.checked) {
    v3mDescriptionContainer.style.display = 'block';
  } else {
    v3mDescriptionContainer.style.display = 'none';
    document.getElementById('description_v3m').value = '';
  }
}
function toggleFODescription() {
  var foCheckbox = document.getElementById('fo');
  var foDescriptionContainer = document.getElementById('fo-description-container');
  if (foCheckbox.checked) {
    foDescriptionContainer.style.display = 'block';
  } else {
    foDescriptionContainer.style.display = 'none';
    document.getElementById('description_fo').value = '';
  }
}
function toggleCEDescription() {
  var ceCheckbox = document.getElementById('ce');
  var ceDescriptionContainer = document.getElementById('ce-description-container');
  if (ceCheckbox.checked) {
    ceDescriptionContainer.style.display = 'block';
  } else {
    ceDescriptionContainer.style.display = 'none';
    document.getElementById('description_ce').value = '';
  }
}
function toggleSCJRDescription() {
  var scjrCheckbox = document.getElementById('scjr');
  var scjrDescriptionContainer = document.getElementById('scjr-description-container');
  if (scjrCheckbox.checked) {
    scjrDescriptionContainer.style.display = 'block';
  } else {
    scjrDescriptionContainer.style.display = 'none';
    document.getElementById('description_scjr').value = '';
  }
}
function toggleVIDescription() {
  var viCheckbox = document.getElementById('vi');
  var viDescriptionContainer = document.getElementById('vi-description-container');
  if (viCheckbox.checked) {
    viDescriptionContainer.style.display = 'block';
  } else {
    viDescriptionContainer.style.display = 'none';
    document.getElementById('description_vi').value = '';
  }
}
function toggleAblationFilsDescription() {
  var ablationFilsCheckbox = document.getElementById('ablation_fils');
  var ablationFilsDescriptionContainer = document.getElementById('ablation_fils-description-container');
  if (ablationFilsCheckbox.checked) {
    ablationFilsDescriptionContainer.style.display = 'block';
  } else {
    ablationFilsDescriptionContainer.style.display = 'none';
    document.getElementById('description_ablation_fils').value = '';
  }
}
function toggleEchoADescription() {
  var echoACheckbox = document.getElementById('echo_a');
  var echoADescriptionContainer = document.getElementById('echo_a-description-container');
  if (echoACheckbox.checked) {
    echoADescriptionContainer.style.display = 'block';
  } else {
    echoADescriptionContainer.style.display = 'none';
    document.getElementById('description_echo_a').value = '';
  }
}
function toggleEchoBDescription() {
  var echoBCheckbox = document.getElementById('echo_b');
  var echoBDescriptionContainer = document.getElementById('echo_b-description-container');
  if (echoBCheckbox.checked) {
    echoBDescriptionContainer.style.display = 'block';
  } else {
    echoBDescriptionContainer.style.display = 'none';
    document.getElementById('description_echo_b').value = '';
  }
}
function toggleSkiascopieDescription() {
  var skiascopieCheckbox = document.getElementById('skiascopie');
  var skiascopieDescriptionContainer = document.getElementById('skiascopie-description-container');
  if (skiascopieCheckbox.checked) {
    skiascopieDescriptionContainer.style.display = 'block';
  } else {
    skiascopieDescriptionContainer.style.display = 'none';
    document.getElementById('description_skiascopie').value = '';
  }
}
function toggleLaserArgonDescription() {
  var laserArgonCheckbox = document.getElementById('laser_argon');
  var laserArgonDescriptionContainer = document.getElementById('laser_argon-description-container');
  if (laserArgonCheckbox.checked) {
    laserArgonDescriptionContainer.style.display = 'block';
  } else {
    laserArgonDescriptionContainer.style.display = 'none';
    document.getElementById('description_laser_argon').value = '';
  }
}
function toggleLaserYAGDescription() {
  var laserYAGCheckbox = document.getElementById('laser_yag');
  var laserYAGDescriptionContainer = document.getElementById('laser_yag-description-container');
  if (laserYAGCheckbox.checked) {
    laserYAGDescriptionContainer.style.display = 'block';
  } else {
    laserYAGDescriptionContainer.style.display = 'none';
    document.getElementById('description_laser_yag').value = '';
  }
}
function toggleAngioDescription() {
  var angioCheckbox = document.getElementById('angio');
  var angioDescriptionContainer = document.getElementById('angio-description-container');
  if (angioCheckbox.checked) {
    angioDescriptionContainer.style.display = 'block';
  } else {
    angioDescriptionContainer.style.display = 'none';
    document.getElementById('description_angio').value = '';
  }
}
function toggleLentilleTherapDescription() {
  var lentilleTherapCheckbox = document.getElementById('lentille_therap');
  var lentilleTherapDescriptionContainer = document.getElementById('lentille_therap-description-container');
  if (lentilleTherapCheckbox.checked) {
    lentilleTherapDescriptionContainer.style.display = 'block';
  } else {
    lentilleTherapDescriptionContainer.style.display = 'none';
    document.getElementById('description_lentille_therap').value = '';
  }
}
function toggleBouchonsLacrymDescription() {
  var bouchonsLacrymCheckbox = document.getElementById('bouchons_lacrym');
  var bouchonsLacrymDescriptionContainer = document.getElementById('bouchons_lacrym-description-container');
  if (bouchonsLacrymCheckbox.checked) {
    bouchonsLacrymDescriptionContainer.style.display = 'block';
  } else {
    bouchonsLacrymDescriptionContainer.style.display = 'none';
    document.getElementById('description_bouchons_lacrym').value = '';
  }
}
function toggleKeratoconiqueStade() {
  var keratoconiqueCheckbox = document.getElementById('keratoconique');
  var keratoconiqueStadeContainer = document.getElementById('keratoconique-stade-container');
  if (keratoconiqueCheckbox.checked) {
    keratoconiqueStadeContainer.style.display = 'block';
  } else {
    keratoconiqueStadeContainer.style.display = 'none';
    document.getElementById('stade_keratoconique').value = '';
  }
}
function toggleGlaucomeType() {
  var glaucomeCheckbox = document.getElementById('glaucome');
  var glaucomeTypeContainer = document.getElementById('glaucome-type-container');
  if (glaucomeCheckbox.checked) {
    glaucomeTypeContainer.style.display = 'block';
  } else {
    glaucomeTypeContainer.style.display = 'none';
    document.getElementById('glaucome_type').value = '';
  }
}
function toggleUveiteType() {
  var uveiteCheckbox = document.getElementById('uveite');
  var uveiteTypeContainer = document.getElementById('uveite-type-container');
  if (uveiteCheckbox.checked) {
    uveiteTypeContainer.style.display = 'block';
  } else {
    uveiteTypeContainer.style.display = 'none';
    document.getElementById('uveite_type').value = '';
  }
}
function toggleConjonctiviteType() {
  var conjonctiviteCheckbox = document.getElementById('conjonctivite');
  var conjonctiviteTypeContainer = document.getElementById('conjonctivite-type-container');
  if (conjonctiviteCheckbox.checked) {
    conjonctiviteTypeContainer.style.display = 'block';
  } else {
    conjonctiviteTypeContainer.style.display = 'none';
    document.getElementById('conjonctivite_type').value = '';
  }
}
function toggleScleroseType() {
  var scleroseCheckbox = document.getElementById('sclerose');
  var scleroseTypeContainer = document.getElementById('sclerose-type-container');
  if (scleroseCheckbox.checked) {
    scleroseTypeContainer.style.display = 'block';
  } else {
    scleroseTypeContainer.style.display = 'none';
    document.getElementById('sclerose_type').value = '';
  }
}
function toggleTestCouleurDescription() {
  var testCouleurCheckbox = document.getElementById('test_couleur');
  var testCouleurDescriptionContainer = document.getElementById('test_couleur-description-container');
  if (testCouleurCheckbox.checked) {
    testCouleurDescriptionContainer.style.display = 'block';
  } else {
    testCouleurDescriptionContainer.style.display = 'none';
    document.getElementById('description_test_couleur').value = '';
  }
}
function toggleTestLarmesDescription() {
  var testLarmesCheckbox = document.getElementById('test_larmes');
  var testLarmesDescriptionContainer = document.getElementById('test_larmes-description-container');
  if (testLarmesCheckbox.checked) {
    testLarmesDescriptionContainer.style.display = 'block';
  } else {
    testLarmesDescriptionContainer.style.display = 'none';
    document.getElementById('description_test_larmes').value = '';
  }
}
function toggleTonometryDescription() {
  var tonometryCheckbox = document.getElementById('tonometry');
  var tonometryDescriptionContainer = document.getElementById('tonometry-description-container');
  if (tonometryCheckbox.checked) {
    tonometryDescriptionContainer.style.display = 'block';
  } else {
    tonometryDescriptionContainer.style.display = 'none';
    document.getElementById('description_tonometry').value = '';
  }
}
function toggleAcuiteVisuelleBruteDescription() {
  var acuiteVisuelleBruteCheckbox = document.getElementById('acuite_visuelle_brute');
  var acuiteVisuelleBruteDescriptionContainer = document.getElementById('acuite_visuelle_brute-description-container');
  if (acuiteVisuelleBruteCheckbox.checked) {
    acuiteVisuelleBruteDescriptionContainer.style.display = 'block';
  } else {
    acuiteVisuelleBruteDescriptionContainer.style.display = 'none';
    document.getElementById('description_acuite_visuelle_brute').value = '';
  }
}
function toggleAcuiteVisuelleCorrectionDescription() {
  var acuiteVisuelleCorrectionCheckbox = document.getElementById('acuite_visuelle_correction');
  var acuiteVisuelleCorrectionDescriptionContainer = document.getElementById('acuite_visuelle_correction-description-container');
  if (acuiteVisuelleCorrectionCheckbox.checked) {
    acuiteVisuelleCorrectionDescriptionContainer.style.display = 'block';
  } else {
    acuiteVisuelleCorrectionDescriptionContainer.style.display = 'none';
    document.getElementById('description_acuite_visuelle_correction').value = '';
  }
}
function toggleAcuiteVisuelleCycloplefieDescription() {
  var acuiteVisuelleCycloplefieCheckbox = document.getElementById('acuite_visuelle_cycloplefie');
  var acuiteVisuelleCycloplefieDescriptionContainer = document.getElementById('acuite_visuelle_cycloplefie-description-container');
  if (acuiteVisuelleCycloplefieCheckbox.checked) {
    acuiteVisuelleCycloplefieDescriptionContainer.style.display = 'block';
  } else {
    acuiteVisuelleCycloplefieDescriptionContainer.style.display = 'none';
    document.getElementById('description_acuite_visuelle_cycloplefie').value = '';
  }
}
function toggleAmplitudeAccommodationDescription() {
  var amplitudeAccommodationCheckbox = document.getElementById('amplitude_accommodation');
  var amplitudeAccommodationDescriptionContainer = document.getElementById('amplitude_accommodation-description-container');
  if (amplitudeAccommodationCheckbox.checked) {
    amplitudeAccommodationDescriptionContainer.style.display = 'block';
  } else {
    amplitudeAccommodationDescriptionContainer.style.display = 'none';
    document.getElementById('description_amplitude_accommodation').value = '';
  }
}
function toggleFlexibiliteAccommodativeDescription() {
  var flexibiliteAccommodativeCheckbox = document.getElementById('flexibilite_accommodative');
  var flexibiliteAccommodativeDescriptionContainer = document.getElementById('flexibilite_accommodative-description-container');
  if (flexibiliteAccommodativeCheckbox.checked) {
    flexibiliteAccommodativeDescriptionContainer.style.display = 'block';
  } else {
    flexibiliteAccommodativeDescriptionContainer.style.display = 'none';
    document.getElementById('description_flexibilite_accommodative').value = '';
  }
}
function toggleReponseAccommodativeDescription() {
  var reponseAccommodativeCheckbox = document.getElementById('reponse_accommodative');
  var reponseAccommodativeDescriptionContainer = document.getElementById('reponse_accommodative-description-container');
  if (reponseAccommodativeCheckbox.checked) {
    reponseAccommodativeDescriptionContainer.style.display = 'block';
  } else {
    reponseAccommodativeDescriptionContainer.style.display = 'none';
    document.getElementById('description_reponse_accommodative').value = '';
  }
}
function toggleTestsMusclesOculomoteursDescription() {
  var testsMusclesOculomoteursCheckbox = document.getElementById('tests_muscles_oculomoteurs');
  var testsMusclesOculomoteursDescriptionContainer = document.getElementById('tests_muscles_oculomoteurs-description-container');
  if (testsMusclesOculomoteursCheckbox.checked) {
    testsMusclesOculomoteursDescriptionContainer.style.display = 'block';
  } else {
    testsMusclesOculomoteursDescriptionContainer.style.display = 'none';
    document.getElementById('description_tests_muscles_oculomoteurs').value = '';
  }
}
function toggleCoverTestDescription() {
  var coverTestCheckbox = document.getElementById('cover_test');
  var coverTestDescriptionContainer = document.getElementById('cover_test-description-container');
  if (coverTestCheckbox.checked) {
    coverTestDescriptionContainer.style.display = 'block';
  } else {
    coverTestDescriptionContainer.style.display = 'none';
    document.getElementById('description_cover_test').value = '';
  }
}
function toggleHeterophoriesDescription() {
  var heterophoriesCheckbox = document.getElementById('heterophories');
  var heterophoriesDescriptionContainer = document.getElementById('heterophories-description-container');
  if (heterophoriesCheckbox.checked) {
    heterophoriesDescriptionContainer.style.display = 'block';
  } else {
    heterophoriesDescriptionContainer.style.display = 'none';
    document.getElementById('description_heterophories').value = '';
  }
}
function toggleVergencesDescription() {
  var vergencesCheckbox = document.getElementById('vergences');
  var vergencesDescriptionContainer = document.getElementById('vergences-description-container');
  if (vergencesCheckbox.checked) {
    vergencesDescriptionContainer.style.display = 'block';
  } else {
    vergencesDescriptionContainer.style.display = 'none';
    document.getElementById('description_vergences').value = '';
  }
}
function toggleTestMaddoxDescription() {
  var testMaddoxCheckbox = document.getElementById('test_maddox');
  var testMaddoxDescriptionContainer = document.getElementById('test_maddox-description-container');
  if (testMaddoxCheckbox.checked) {
    testMaddoxDescriptionContainer.style.display = 'block';
  } else {
    testMaddoxDescriptionContainer.style.display = 'none';
    document.getElementById('description_test_maddox').value = '';
  }
}
function toggleTestWorthDescription() {
  var testWorthCheckbox = document.getElementById('test_worth');
  var testWorthDescriptionContainer = document.getElementById('test_worth-description-container');
  if (testWorthCheckbox.checked) {
    testWorthDescriptionContainer.style.display = 'block';
  } else {
    testWorthDescriptionContainer.style.display = 'none';
    document.getElementById('description_test_worth').value = '';
  }
}
function toggleSterescopieDescription() {
  var stereoscopieCheckbox = document.getElementById('stereoscopie');
  var stereoscopieDescriptionContainer = document.getElementById('stereoscopie-description-container');
  if (stereoscopieCheckbox.checked) {
    stereoscopieDescriptionContainer.style.display = 'block';
  } else {
    stereoscopieDescriptionContainer.style.display = 'none';
    document.getElementById('description_stereoscopie').value = '';
  }
}
function toggleKeratometrieDescription() {
  var keratometrieCheckbox = document.getElementById('keratometrie');
  var keratometrieDescriptionContainer = document.getElementById('keratometrie-description-container');
  if (keratometrieCheckbox.checked) {
    keratometrieDescriptionContainer.style.display = 'block';
  } else {
    keratometrieDescriptionContainer.style.display = 'none';
    document.getElementById('description_keratometrie').value = '';
  }
}
// Lentille de contact JS
function toggleLentilleSoupleOptions() {
  var soupleCheckbox = document.getElementById('lentille_souple');
  var soupleOptions = document.getElementById('lentille-souple-options');
  soupleOptions.style.display = soupleCheckbox.checked ? 'block' : 'none';
  if (!soupleCheckbox.checked) {
    document.getElementById('lentille_souple_spherique').checked = false;
    document.getElementById('lentille_souple_torique').checked = false;
  }
}
function toggleLentilleRPGOptions() {
  var rpgCheckbox = document.getElementById('lentille_rpg');
  var rpgOptions = document.getElementById('lentille-rpg-options');
  rpgOptions.style.display = rpgCheckbox.checked ? 'block' : 'none';
  if (!rpgCheckbox.checked) {
    document.getElementById('lrpg_spherique').checked = false;
    document.getElementById('lrpg_torique_ant').checked = false;
    document.getElementById('lrpg_torique_post').checked = false;
    document.getElementById('lrpg_bitorique').checked = false;
  }
}
// Fin Lentille de contact JS

document.addEventListener('DOMContentLoaded', function () {
  const headers = document.querySelectorAll('.accordion-header');

  headers.forEach(header => {
    header.addEventListener('click', () => {
      const targetId = header.getAttribute('data-target');
      const content = document.getElementById(targetId);

      // Fermer tous les autres
      document.querySelectorAll('.accordion-content').forEach(c => {
        if (c.id !== targetId) {
          c.classList.remove('open');
        }
      });
      document.querySelectorAll('.accordion-header').forEach(h => {
        if (h !== header) {
          h.classList.remove('active');
        }
      });

      // Toggle l'actuel
      content.classList.toggle('open');
      header.classList.toggle('active');
    });
  });
});

</script>
{% endblock %}
